                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         

int GetRootMapData(Map&map,uint index)
{
	return map.GetLocation().GetMapByIndex(0).GetData(index);
}  

void SetRootMapData(Map&map,uint index,int val)
{
	map.GetLocation().GetMapByIndex(0).SetData(index,val);
}   

int GetRootMapData(Location&loc,uint index)
{
	return loc.GetMapByIndex(0).GetData(index);
}  

void SetRootMapData(Location&loc,uint index,int val)
{
	loc.GetMapByIndex(0).SetData(index,val);
}                                                                                                                                                                                                  

bool dbInitTable(string@,string@){return true;}
bool dbLog(string@,string@){return true;}                   

void InitDBLogs(){}

void LogExperience(Critter&cr,int amount){}
void LogExperience(Critter&cr,int amount,string@info){}
void LogExperience(Critter&cr,int amount,int skill){}
void LogExperience(Critter&cr,int amount,int skill,string@info){}
void LogExperience(Critter&cr,int amount,int skill,int param){}
void LogExperience(Critter&cr,int amount,int skill,string@info,int param){}
void LogQuestExperience(Critter&cr,int amount,string@info){}
void LogQuestExperience(Critter&cr,int amount,int skill,string@info){}
void LogAttack(Map@map,Critter&cr,Critter&target,ProtoItem&weapon,ProtoItem@ammo,uint8 aim,bool isBurst,uint ammoRound,uint weaponRound,bool isHit,bool isCritical,uint critfailFlags){}
void LogDamage(Map@map,Critter@attacker,Critter&target,Item@weapon,ProtoItem@ammo,uint8 aim,bool isBurst,uint damage,bool isCritical,uint eff,uint rounds){}
void LogGathering(Critter&,uint16,int){}                        

import void StartSlaverunCombat(Map@map)from"slaverun";
import void SlaversAnnounceSuccess(Map@map)from"slaverun";

void critter_init(Critter&npc,bool firstTime)
{
	npc.SetEvent((2),"_SlaveHostileOnDead");
	npc.SetEvent((16),"_SlaveHostileOnAttacked");
	npc.SetEvent((0),"_Idle");
	(npc.ModeBase[(534)]=npc.Mode[(534)]|((0x00000080)));
}

void _SlaveHostileOnDead(Critter&crit,Critter@killer)
{
	uint id=crit.GetMap().GetData((21));
	GameVar@hostiles_killed=GetLocalVar((11107),id);
	GameVar@hostiles=GetLocalVar((11104),id);
	hostiles_killed+=1;
	
	GameVar@status=GetLocalVar((11100),id);
	Critter@player=GetCritter(id);
	
	uint ustatus=status.GetValue();
	
	if((((ustatus)&((0x10)))!=0))
	return;
	if(hostiles_killed.GetValue()==hostiles.GetValue())
	{
		((ustatus)=(ustatus)|((0x80)));
		SlaversAnnounceSuccess(crit.GetMap());
		if((@player!=null))
		player.Say((11),"You've killed all hostile slaves. Your work here is complete.");
	}
	
	status=ustatus;
}

bool _SlaveHostileOnAttacked(Critter&crit,Critter&attacker)
{
	
	StartSlaverunCombat(crit.GetMap());
	return false;
}

void _Idle(Critter&npc)
{
	if(Random(0,5)==0)
	npc.MoveRandom();
	npc.Wait(Random(2000,10000));
}

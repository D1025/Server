                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                

import void WLog(string&type,string&message)from"debug";
import void WLog(string&type,string&message,int level)from"debug";
import void InitDebug()from"debug";   

import void ConsumeBlueprint(Critter&player,Item&item)from"blueprints";
import bool ConsumedBlueprint(Critter&player,uint pid)from"blueprints";
import uint16 GetRandomTypeBlueprintPid(int8 type,uint8 level)from"blueprints";

void _BlueprintInit(Item&item,bool firstTime)
{
	
}

void _RandomBlueprintInit(Item&item,bool firstTime)
{
	uint16 pid=GetRandomTypeBlueprintPid(item.Proto.Blueprint_Type,item.Proto.Blueprint_Level);
	if(pid==0)
	{
		WLog("blueprints","no blueprints for item type "+item.Proto.Blueprint_Type+", level "+item.Proto.Blueprint_Level,20);
		DeleteItem(item);
		return;
	}
	item.ChangeProto(pid);
	item.SetScript("_BlueprintInit");
	item.Update();
}

bool _Used(Item&item,Critter&player,Critter@onCritter,Item@onItem,Scenery@onScenery)
{
	if((@onCritter!=null)||(@onItem!=null)||(@onScenery!=null))
	return false;
	
	if(ConsumedBlueprint(player,item.GetProtoId()))
	return false;
	ConsumeBlueprint(player,item);
	return true;
}
